(()=>{"use strict";class t{hits=0;constructor(t){this.length=t}hit(){this.hits++}isSunk(){return!(this.hits<this.length)}}class e{ships=[];constructor(t){this.grid=new Array(t),this.gridSize=t;for(let e=0;e<t;e++)this.grid[e]=Array(t).fill(0)}AddShipToGrid(e,i,s){if(1===s){if(!1===this.validVerticalInput(i,e))return!1;this.placeShipVertical(i,e,this.ships.length+1)}else{if(!1===this.validHorizontalInput(i,e))return!1;this.placeShipHorizontal(i,e,this.ships.length+1)}return this.ships.push(new t(e)),this.ships[this.ships.length-1],!0}placeShipHorizontal(t,e,i){for(let s=0;s<e;s++)this.grid[t.y][t.x+s]=i}placeShipVertical(t,e,i){for(let s=0;s<e;s++)this.grid[t.y+s][t.x]=i}AllSunk(){for(let t=0;t<this.ships.length;t++)if(!1===this.ships[t].isSunk())return!1;return!0}validHorizontalInput(t,e){for(let i=0;i<e;i++)if(!1===this.validInput(t.y,t.x+i))return!1;return!0}validVerticalInput(t,e){for(let i=0;i<e;i++)if(!1===this.validInput(t.y+i,t.x))return!1;return!0}validInput(t,e){return!(e>=this.gridSize||e<0||t>=this.gridSize||t<0||0!==this.grid[t][e])}validShotInput(t,e){return!(e>=this.gridSize||e<0||t>=this.gridSize||t<0||-1===this.grid[t][e])}ReceiveAttack(t){if(!this.validShotInput(t.y,t.x))throw new Error("Invalid Input");return 0===this.grid[t.y][t.x]?(this.grid[t.y][t.x]=-1,0):(this.ships[this.grid[t.y][t.x]-1].hit(),this.grid[t.y][t.x]=-1,1)}}function i(){let t=document.createElement("div");t.classList.add("board");let e=document.createElement("div");e.classList.add("name"),e.textContent="Player",t.appendChild(e);let i=document.createElement("div");i.classList.add("tiles");for(let t=0;t<10;t++)for(let e=0;e<10;e++){let s=document.createElement("div");s.classList.add("tile"),s.dataset.row=t,s.dataset.col=e,i.appendChild(s)}return t.appendChild(i),t}function s(t,e){t.querySelector(".name").textContent=e}let r,l=[],n=[5,4,3,3,2],o=0;const a=document.querySelector(".modal");document.querySelector(".modal-content");let d=new e(10);new e(10);const c=document.querySelector(".game");let h=i(),u=i();c.insertBefore(h,c.firstChild),c.appendChild(u);let p=h.querySelector(".tiles"),y=u.querySelector(".tiles"),f=document.querySelector("#PvE"),g=document.querySelector("#PvP");function v(t){[...t.children].forEach((t=>{t.classList.add("disabled")}))}function S(t,e){[...t.children].forEach((i=>{i.addEventListener("mouseover",(()=>{!function(t,e){l.forEach((t=>{t.classList.remove("hit"),t.classList.remove("valid")})),l=[];let i={x:+t.dataset.col,y:+t.dataset.row};l=0===r?function(t,e){let i=[];for(let s=0;s<n[o];s++){let r=t.x+s,l=e.querySelector(`[data-row="${t.y}"][data-col="${r}"]`);null==l||l.classList.contains("occupied")||i.push(l)}return console.log(i),i}(i,e):function(t,e){let i=[];for(let s=0;s<n[o];s++){let r=e.querySelector(`[data-row="${t.y+s}"][data-col="${t.x}"]`);null==r||r.classList.contains("occupied")||i.push(r)}return i}(i,e),l.length==n[o]?l.forEach((t=>{t.classList.add("valid")})):l.forEach((t=>{t.classList.add("hit")}))}(i,t)})),i.addEventListener("click",(()=>{let t={x:+i.dataset.col,y:+i.dataset.row};d.AddShipToGrid(n[o],t,r)&&(l.forEach((t=>{t.classList.add("occupied")})),o++,o===n.length&&(e?console.log("PvP Move onto next player, show blank screen,tear down events and add to other grid"):console.log("PvE Start Game set up, tear dwon events and start game loop")))}))}))}f.addEventListener("click",(()=>{console.log("selected Player Versus Computer"),a.style.display="none",s(h,"Computer"),s(u,"You"),v(p),r=0,S(y,0)})),g.addEventListener("click",(()=>{console.log("selected Player Versus Player"),console.log("Display player names"),a.style.display="none",r=0,v(p),S(y,1)}))})();