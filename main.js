(()=>{"use strict";class t{hits=0;constructor(t){this.length=t}hit(){this.hits++}isSunk(){return!(this.hits<this.length)}}class e{ships=[];constructor(t){this.grid=new Array(t),this.gridSize=t;for(let e=0;e<t;e++)this.grid[e]=Array(t).fill(0)}AddShipToGrid(e,i,r){if(1===r){if(!1===this.validVerticalInput(i,e))return!1;this.placeShipVertical(i,e,this.ships.length+1)}else{if(!1===this.validHorizontalInput(i,e))return!1;this.placeShipHorizontal(i,e,this.ships.length+1)}return this.ships.push(new t(e)),this.ships[this.ships.length-1],!0}placeShipHorizontal(t,e,i){for(let r=0;r<e;r++)this.grid[t.y][t.x+r]=i}placeShipVertical(t,e,i){for(let r=0;r<e;r++)this.grid[t.y+r][t.x]=i}AllSunk(){for(let t=0;t<this.ships.length;t++)if(!1===this.ships[t].isSunk())return!1;return!0}validHorizontalInput(t,e){for(let i=0;i<e;i++)if(!1===this.validInput(t.y,t.x+i))return!1;return!0}validVerticalInput(t,e){for(let i=0;i<e;i++)if(!1===this.validInput(t.y+i,t.x))return!1;return!0}validInput(t,e){return!(e>=this.gridSize||e<0||t>=this.gridSize||t<0||0!==this.grid[t][e])}validShotInput(t,e){return!(e>=this.gridSize||e<0||t>=this.gridSize||t<0||-1===this.grid[t][e])}ReceiveAttack(t){if(!this.validShotInput(t.y,t.x))throw new Error("Invalid Input");return 0===this.grid[t.y][t.x]?(this.grid[t.y][t.x]=-1,0):(this.ships[this.grid[t.y][t.x]-1].hit(),this.grid[t.y][t.x]=-1,1)}}class i{constructor(t,e){this.playerName=t,this.gameBoard=e}MakeMove(t){try{return this.gameBoard.ReceiveAttack(t)}catch{return-1}}}class r extends i{constructor(t,e){super(t,e),this.moves=[]}MakeRandomMove(){let t=this.getRandomInt(this.gameBoard.grid.length),e=this.getRandomInt(this.gameBoard.grid.length),i=this.getValidShot(t,e);return{status:this.MakeMove(i),coords:i}}getRandomInt(t){return Math.floor(Math.random()*t)}placeRandomShipsOnBoard(){let t=[5,4,3,3,2];for(let e=0;e<t.length;e++){let i=this.getRandomInt(2),r=0,s=0;1===i?(r=this.getRandomInt(this.gameBoard.grid.length),s=this.getRandomInt(this.gameBoard.grid.length-t[e])):(r=this.getRandomInt(this.gameBoard.grid.length-t[e]),s=this.getRandomInt(this.gameBoard.grid.length));let a={x:r,y:s};!1===this.gameBoard.AddShipToGrid(t[e],a,i)&&e--}}getValidShot(t,e){let i=e,r=t;if(-1!==this.gameBoard.grid[i][r])return{x:r,y:i};for(let t=e;t<this.gameBoard.grid.length+1;t++){t===this.gameBoard.grid.length&&(t=0);for(let e=0;e<this.gameBoard.grid.length;e++)if(-1!==this.gameBoard.grid[t][e])return{x:e,y:t}}}}function s(){let t=document.createElement("div");t.classList.add("board");let e=document.createElement("div");e.classList.add("tiles");for(let t=0;t<10;t++)for(let i=0;i<10;i++){let r=document.createElement("div");r.classList.add("tile"),r.dataset.row=t,r.dataset.col=i,e.appendChild(r)}return t.appendChild(e),t}let a=new e(10),d=new e(10);const o=document.querySelector(".game");let l=new s,n=new s;o.insertBefore(l,o.firstChild),o.appendChild(n);let h=l.querySelector(".tiles"),g=n.querySelector(".tiles");[...h.children].forEach((t=>{t.addEventListener("click",(()=>{console.log(`x: ${t.dataset.col} y: ${t.dataset.row}`)}))})),[...g.children].forEach((t=>{t.addEventListener("click",(()=>{console.log(`x: ${t.dataset.col} y: ${t.dataset.row}`)}))}));let c=new r("Computer",d),u=new r("Computer2",a);for(c.placeRandomShipsOnBoard(),u.placeRandomShipsOnBoard();!0!==c.gameBoard.AllSunk()&&!0!==u.gameBoard.AllSunk();){let t=u.MakeRandomMove(),e=h.querySelector(`[data-row="${t.coords.y}"][data-col="${t.coords.x}"]`);if(1===t.status?e.classList.add("hit"):e.classList.add("miss"),u.gameBoard.AllSunk()){console.log("Computer2 Wins");break}if(t=c.MakeRandomMove(),e=g.querySelector(`[data-row="${t.coords.y}"][data-col="${t.coords.x}"]`),1===t.status?e.classList.add("hit"):e.classList.add("miss"),c.gameBoard.AllSunk()){console.log("Computer Wins");break}}})();